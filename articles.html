---
layout: default
title: Browse Articles
permalink: /articles/
---

<div class="articles-header">
    <div class="header-content">
        <h1><i class="fas fa-archive"></i> Browse Articles</h1>
        <p class="header-subtitle">Explore our complete collection of digitized newspaper clippings</p>
    </div>
    <div class="results-info" id="resultsInfo">
        Loading articles...
    </div>
    <div class="sort-controls">
        <label for="sortSelect">Sort by:</label>
        <select id="sortSelect" class="sort-select">
            <option value="date-desc">Date (Newest First)</option>
            <option value="date-asc">Date (Oldest First)</option>
            <option value="title-asc">Title (A-Z)</option>
            <option value="title-desc">Title (Z-A)</option>
            <option value="source-asc">Source (A-Z)</option>
            <option value="relevance">Relevance</option>
        </select>
    </div>
</div>

<div class="articles-content">
    <div id="articlesContainer">
        <!-- Articles will be loaded here by JavaScript -->
        <div class="loading-articles">
            <div class="loading-spinner-inline">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Loading articles...</p>
            </div>
        </div>
    </div>
    
    <div id="paginationContainer">
        <!-- Pagination will be added here -->
    </div>
</div>

<!-- Article Detail Modal -->
<div id="articleModal" class="modal">
    <div class="modal-content article-modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Article Details</h2>
            <span class="modal-close">&times;</span>
        </div>
        <div class="modal-body">
            <div class="article-detail">
                <div class="article-top-section">
                    <div class="article-image-section">
                        <img id="modalImage" src="" alt="" class="modal-article-image">
                        <div class="image-actions">
                            <button class="btn btn-sm" onclick="archive.openLightbox(document.getElementById('modalImage'))">
                                <i class="fas fa-expand"></i> View Full Size
                            </button>
                        </div>
                    </div>
                    <div class="article-info-section">
                        <div class="article-meta-detailed">
                            <div class="meta-row">
                                <span class="meta-label"><i class="fas fa-calendar"></i> Date:</span>
                                <span class="meta-value" id="modalDate"></span>
                            </div>
                            <div class="meta-row">
                                <span class="meta-label"><i class="fas fa-newspaper"></i> Source:</span>
                                <span class="meta-value" id="modalSource"></span>
                            </div>
                            <div class="meta-row">
                                <span class="meta-label"><i class="fas fa-map-marker-alt"></i> Location:</span>
                                <span class="meta-value" id="modalLocation"></span>
                            </div>
                            <div class="meta-row">
                                <span class="meta-label"><i class="fas fa-users"></i> People:</span>
                                <span class="meta-value" id="modalPeople"></span>
                            </div>
                            <div class="meta-row">
                                <span class="meta-label"><i class="fas fa-tags"></i> Tags:</span>
                                <span class="meta-value" id="modalTags"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="article-content-section">
                    <h4>Article Content:</h4>
                    <div class="article-text" id="modalContent"></div>
                </div>
                <div class="article-actions">
                        <button class="btn btn-primary" onclick="generateCitation()">
                            <i class="fas fa-quote-right"></i> Generate Citation
                        </button>
                        <button class="btn btn-secondary" onclick="printArticle()">
                            <i class="fas fa-print"></i> Print
                        </button>
                        <button class="btn btn-outline" onclick="shareArticle()">
                            <i class="fas fa-share"></i> Share
                        </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Citation Modal -->
<div id="citationModal" class="modal">
    <div class="modal-content citation-modal-content">
        <div class="modal-header">
            <h2>Academic Citation</h2>
            <span class="modal-close">&times;</span>
        </div>
        <div class="modal-body">
            <div class="citation-formats">
                <div class="citation-format">
                    <h4>APA Format:</h4>
                    <div class="citation-text" id="citationAPA"></div>
                    <button class="copy-btn" onclick="copyCitation('APA')">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
                <div class="citation-format">
                    <h4>MLA Format:</h4>
                    <div class="citation-text" id="citationMLA"></div>
                    <button class="copy-btn" onclick="copyCitation('MLA')">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
                <div class="citation-format">
                    <h4>Chicago Format:</h4>
                    <div class="citation-text" id="citationChicago"></div>
                    <button class="copy-btn" onclick="copyCitation('Chicago')">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Articles page specific styles */
.articles-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 2px solid var(--border-color);
    flex-wrap: wrap;
    gap: 1rem;
}

.header-content h1 {
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    font-size: 2rem;
}

.header-subtitle {
    color: var(--text-secondary);
    font-size: 1.1rem;
    margin: 0;
}

.results-info {
    color: var(--text-muted);
    font-size: 0.95rem;
    padding: 0.5rem 1rem;
    background: var(--background-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
}

.sort-controls {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.sort-controls label {
    font-weight: 500;
    color: var(--text-secondary);
}

.sort-select {
    padding: 0.5rem 1rem;
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    background: var(--surface-color);
    color: var(--text-primary);
    min-width: 180px;
}

.articles-content {
    min-height: 60vh;
}

.loading-articles {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 300px;
}

.loading-spinner-inline {
    text-align: center;
    color: var(--text-muted);
}

.loading-spinner-inline i {
    font-size: 2rem;
    margin-bottom: 1rem;
    color: var(--primary-color);
}

.articles-grid {
    display: grid;
    gap: 2rem;
    margin-bottom: 3rem;
}

.article-card {
    display: grid;
    grid-template-columns: 250px 1fr auto;
    gap: 1.5rem;
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    box-shadow: var(--shadow-sm);
    transition: var(--transition);
    align-items: start;
}

.article-card:hover {
    box-shadow: var(--shadow-md);
    border-color: var(--primary-color);
    transform: translateY(-2px);
}

.article-image {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition);
    border: 1px solid var(--border-color);
}

.article-image:hover {
    transform: scale(1.02);
    border-color: var(--primary-color);
}

.article-details {
    flex: 1;
}

.article-details h3 {
    font-size: 1.3rem;
    margin-bottom: 1rem;
    color: var(--text-primary);
    line-height: 1.4;
}

.article-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1.5rem;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    color: var(--text-muted);
}

.meta-item {
    display: flex;
    align-items: center;
    gap: 0.4rem;
}

.meta-item i {
    color: var(--primary-color);
    width: 14px;
}

.article-excerpt {
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 1rem;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.article-people {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.person-tag {
    background: var(--primary-color);
    color: white;
    padding: 0.2rem 0.6rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
}

.person-tag.more {
    background: var(--text-muted);
}

.article-actions {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    align-items: flex-end;
}

.btn-action {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: var(--background-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    color: var(--text-secondary);
    text-decoration: none;
    cursor: pointer;
    transition: var(--transition);
    font-size: 0.85rem;
    white-space: nowrap;
}

.btn-action:hover {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    transform: translateY(-1px);
}

.btn-action i {
    font-size: 0.8rem;
}

/* Article Detail Modal Styles */
.article-modal-content {
    max-width: 1000px;
    max-height: 90vh;
}

.article-detail {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.article-top-section {
    display: grid;
    grid-template-columns: 400px 1fr;
    gap: 2rem;
}

.article-image-section {
    position: sticky;
    top: 0;
}

.modal-article-image {
    width: 100%;
    height: 300px;
    object-fit: cover;
    border-radius: var(--border-radius);
    border: 1px solid var(--border-color);
    margin-bottom: 1rem;
}

.image-actions {
    display: flex;
    justify-content: center;
}

.article-info-section {
    overflow-y: auto;
    max-height: 60vh;
}

.article-meta-detailed {
    background: var(--background-color);
    padding: 1.5rem;
    border-radius: var(--border-radius);
    border: 1px solid var(--border-color);
    margin-bottom: 1.5rem;
}

.meta-row {
    display: grid;
    grid-template-columns: 120px 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
    align-items: start;
}

.meta-row:last-child {
    margin-bottom: 0;
}

.meta-label {
    font-weight: 500;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.meta-label i {
    color: var(--primary-color);
    width: 16px;
}

.meta-value {
    color: var(--text-primary);
    word-wrap: break-word;
}

.article-content-section {
    width: 100%;
    margin-top: 1rem;
}

.article-content-section h4 {
    color: var(--text-primary);
    margin-bottom: 1rem;
    border-bottom: 2px solid var(--primary-color);
    padding-bottom: 0.5rem;
}

.article-text {
    background: var(--background-color);
    padding: 2rem;
    border-radius: var(--border-radius);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
    line-height: 1.85;
    white-space: pre-wrap;
    font-family: Georgia, serif;
    font-size: 1.25rem;
    letter-spacing: 0.4px;
}

.article-actions {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: var(--border-radius);
    font-weight: 500;
    text-decoration: none;
    transition: var(--transition);
    border: 1px solid transparent;
    cursor: pointer;
    font-size: 0.9rem;
}

.btn-sm {
    padding: 0.5rem 1rem;
    font-size: 0.8rem;
}

.btn-primary {
    background: var(--primary-color);
    color: white;
}

.btn-primary:hover {
    background: var(--primary-hover);
    transform: translateY(-1px);
}

.btn-secondary {
    background: var(--accent-color);
    color: white;
}

.btn-secondary:hover {
    background: #047857;
    transform: translateY(-1px);
}

.btn-outline {
    background: transparent;
    color: var(--text-primary);
    border-color: var(--border-color);
}

.btn-outline:hover {
    background: var(--text-primary);
    color: var(--surface-color);
    border-color: var(--text-primary);
    transform: translateY(-1px);
}

/* Citation Modal Styles */
.citation-modal-content {
    max-width: 700px;
}

.citation-formats {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.citation-format {
    background: var(--background-color);
    padding: 1.5rem;
    border-radius: var(--border-radius);
    border: 1px solid var(--border-color);
    position: relative;
}

.citation-format h4 {
    color: var(--primary-color);
    margin-bottom: 1rem;
    font-size: 1.1rem;
}

.citation-text {
    background: var(--surface-color);
    padding: 1rem;
    border-radius: var(--border-radius);
    border: 1px solid var(--border-color);
    font-family: 'Courier New', monospace;
    font-size: 0.9rem;
    line-height: 1.5;
    color: var(--text-primary);
    margin-bottom: 1rem;
    white-space: pre-wrap;
    word-wrap: break-word;
}

.copy-btn {
    position: absolute;
    top: 1rem;
    right: 1rem;
    padding: 0.5rem 1rem;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 0.8rem;
    transition: var(--transition);
}

.copy-btn:hover {
    background: var(--primary-hover);
}

.copy-btn.copied {
    background: var(--accent-color);
}

/* No Results State */
.no-results {
    text-align: center;
    padding: 4rem 2rem;
    color: var(--text-muted);
}

.no-results i {
    font-size: 4rem;
    margin-bottom: 1.5rem;
    opacity: 0.5;
}

.no-results h3 {
    color: var(--text-secondary);
    margin-bottom: 1rem;
}

.no-results p {
    font-size: 1.1rem;
    line-height: 1.6;
}

/* Responsive Design */
@media (max-width: 1024px) {
    .articles-header {
        flex-direction: column;
        align-items: stretch;
        gap: 1.5rem;
    }
    
    .header-content {
        text-align: center;
    }
    
    .sort-controls {
        justify-content: center;
    }
    
    .article-card {
        grid-template-columns: 200px 1fr;
        grid-template-rows: auto auto;
    }
    
    .article-actions {
        grid-column: 1 / -1;
        flex-direction: row;
        justify-content: center;
        padding-top: 1rem;
        border-top: 1px solid var(--border-color);
        margin-top: 1rem;
    }
    
    .article-detail {
        gap: 1.5rem;
    }
    
    .article-top-section {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .article-image-section {
        position: static;
    }
    
    .article-text {
        font-size: 1.2rem;
        padding: 1.5rem;
        line-height: 1.75;
    }
    
    .modal-article-image {
        height: 250px;
    }
}

@media (max-width: 768px) {
    .articles-header {
        padding-bottom: 1rem;
    }
    
    .header-content h1 {
        font-size: 1.75rem;
    }
    
    .header-subtitle {
        font-size: 1rem;
    }
    
    .article-card {
        grid-template-columns: 1fr;
        padding: 1rem;
        gap: 1rem;
    }
    
    .article-image {
        height: 150px;
        justify-self: center;
        max-width: 300px;
    }
    
    .article-details {
        text-align: center;
    }
    
    .article-meta {
        justify-content: center;
        gap: 1rem;
    }
    
    .article-people {
        justify-content: center;
    }
    
    .article-actions {
        flex-direction: column;
        align-items: center;
        border-top: none;
        padding-top: 0;
        margin-top: 0;
    }
    
    .btn-action {
        width: 100%;
        max-width: 200px;
        justify-content: center;
    }
    
    .modal-content {
        width: 95%;
        margin: 2% auto;
        max-height: 95vh;
    }
    
    .article-modal-content {
        max-width: none;
    }
    
    .modal-article-image {
        height: 200px;
    }
    
    .meta-row {
        grid-template-columns: 100px 1fr;
        gap: 0.75rem;
    }
    
    .article-actions {
        flex-direction: column;
        gap: 0.75rem;
    }
    
    .btn {
        width: 100%;
        justify-content: center;
    }
}

@media (max-width: 480px) {
    .article-card {
        padding: 0.75rem;
    }
    
    .article-details h3 {
        font-size: 1.1rem;
    }
    
    .article-meta {
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
    }
    
    .meta-row {
        grid-template-columns: 1fr;
        gap: 0.5rem;
        text-align: center;
    }
    
    .meta-label {
        justify-content: center;
        font-weight: 600;
        color: var(--text-primary);
    }
    
    .citation-format {
        padding: 1rem;
    }
    
    .copy-btn {
        position: static;
        width: 100%;
        margin-top: 1rem;
    }
}

/* Toast Notification Styles */
.toast-notification {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
    color: white;
    padding: 1rem 2rem;
    border-radius: 50px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1rem;
    font-weight: 500;
    z-index: 10000;
    opacity: 0;
    transition: all 0.3s ease;
    pointer-events: none;
}

.toast-notification.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
}

.toast-notification i {
    font-size: 1.2rem;
    color: #90EE90;
}

@media (max-width: 768px) {
    .toast-notification {
        padding: 0.75rem 1.5rem;
        font-size: 0.95rem;
        bottom: 20px;
        width: calc(100% - 40px);
        max-width: 400px;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize articles page functionality
    if (typeof archive !== 'undefined') {
        setupArticlesPage();
    }
    
    // Sort functionality
    const sortSelect = document.getElementById('sortSelect');
    if (sortSelect) {
        sortSelect.addEventListener('change', function() {
            if (typeof archive !== 'undefined') {
                archive.currentSortBy = this.value;
                archive.applyFilters();
            }
        });
    }
    
    // Article modal functionality
    setupArticleModal();
    setupCitationModal();
});

function setupArticlesPage() {
    // Update render method to include action buttons
    const originalRenderCard = archive.renderArticleCard;
    archive.renderArticleCard = function(article) {
        const peopleHTML = article.people.slice(0, 5).map(person => 
            `<span class="person-tag">${person}</span>`
        ).join('');
        
        const moreCount = article.people.length > 5 ? article.people.length - 5 : 0;

        return `
            <article class="article-card">
                <div class="article-image-container">
                    <img src="${article.image}" 
                         alt="${article.title}" 
                         class="article-image" 
                         data-title="${article.title}"
                         data-source="${article.source}"
                         loading="lazy">
                </div>
                <div class="article-details">
                    <h3>${article.title}</h3>
                    <div class="article-meta">
                        <span class="meta-item">
                            <i class="fas fa-calendar"></i>
                            ${article.dateText}
                        </span>
                        <span class="meta-item">
                            <i class="fas fa-newspaper"></i>
                            ${article.source}
                        </span>
                        <span class="meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            ${article.location}
                        </span>
                    </div>
                    <div class="article-excerpt">
                        ${article.excerpt}
                    </div>
                    <div class="article-people">
                        ${peopleHTML}
                        ${moreCount > 0 ? `<span class="person-tag more">+${moreCount} more</span>` : ''}
                    </div>
                </div>
                <div class="article-actions">
                    <button class="btn-action" onclick="viewArticleDetail('${article.id}')">
                        <i class="fas fa-eye"></i>
                        View Details
                    </button>
                    <button class="btn-action" onclick="archive.openLightbox(document.querySelector('[data-title=\\\"${article.title.replace(/"/g, '\\"')}\\\"]'))">
                        <i class="fas fa-expand"></i>
                        Full Image
                    </button>
                    <button class="btn-action" onclick="generateCitation('${article.id}')">
                        <i class="fas fa-quote-right"></i>
                        Cite
                    </button>
                </div>
            </article>
        `;
    };
    
    // Add sorting functionality to archive
    archive.currentSortBy = 'date-desc';
    
    const originalApplyFilters = archive.applyFilters;
    archive.applyFilters = function() {
        originalApplyFilters.call(this);
        this.sortArticles();
    };
    
    archive.sortArticles = function() {
        const sortBy = this.currentSortBy || 'date-desc';
        
        this.filteredArticles.sort((a, b) => {
            switch (sortBy) {
                case 'date-desc':
                    return new Date(b.date) - new Date(a.date);
                case 'date-asc':
                    return new Date(a.date) - new Date(b.date);
                case 'title-asc':
                    return a.title.localeCompare(b.title);
                case 'title-desc':
                    return b.title.localeCompare(a.title);
                case 'source-asc':
                    return a.source.localeCompare(b.source);
                case 'relevance':
                default:
                    return 0;
            }
        });
    };
}

function setupArticleModal() {
    const articleModal = document.getElementById('articleModal');
    const modalClose = articleModal?.querySelector('.modal-close');
    
    if (modalClose && articleModal) {
        modalClose.addEventListener('click', () => {
            articleModal.style.display = 'none';
        });
    }
    
    if (articleModal) {
        articleModal.addEventListener('click', (e) => {
            if (e.target === articleModal) {
                articleModal.style.display = 'none';
            }
        });
    }
}

function setupCitationModal() {
    const citationModal = document.getElementById('citationModal');
    const modalClose = citationModal?.querySelector('.modal-close');
    
    if (modalClose && citationModal) {
        modalClose.addEventListener('click', () => {
            citationModal.style.display = 'none';
        });
    }
    
    if (citationModal) {
        citationModal.addEventListener('click', (e) => {
            if (e.target === citationModal) {
                citationModal.style.display = 'none';
            }
        });
    }
}

// Make viewArticleDetail global so it can be called from dynamically generated HTML
window.viewArticleDetail = function(articleId) {
    if (typeof archive === 'undefined') return;
    
    const article = archive.articles.find(a => a.id === articleId);
    if (!article) return;
    
    // Populate modal
    document.getElementById('modalTitle').textContent = article.title;
    // Image path already includes base URL from archive.js
    document.getElementById('modalImage').src = article.image;
    document.getElementById('modalImage').alt = article.title;
    document.getElementById('modalImage').dataset.title = article.title;
    document.getElementById('modalImage').dataset.source = article.source;
    document.getElementById('modalDate').textContent = article.dateText;
    document.getElementById('modalSource').textContent = article.source;
    document.getElementById('modalLocation').textContent = article.location;
    document.getElementById('modalPeople').textContent = article.people.join(', ');
    document.getElementById('modalTags').textContent = article.tags.join(', ');
    document.getElementById('modalContent').textContent = article.content;
    
    // Store current article for citation generation
    window.currentArticle = article;
    
    // Show modal
    document.getElementById('articleModal').style.display = 'block';
}

// Make generateCitation global
window.generateCitation = function(articleId) {
    let article;
    
    if (articleId) {
        if (typeof archive === 'undefined') return;
        article = archive.articles.find(a => a.id === articleId);
    } else {
        article = window.currentArticle;
    }
    
    if (!article) return;
    
    const today = new Date().toLocaleDateString('en-GB');
    const year = new Date(article.date).getFullYear();
    const authors = article.people.length > 0 ? article.people.slice(0, 3).join(', ') : '';
    
    // Generate different citation formats
    const citations = {
        APA: `${authors ? authors + '. ' : ''}(${year}). ${article.title}. ${article.source}. Malayan Athletic Archive. Retrieved ${today}, from ${window.location.origin}`,
        
        MLA: `${authors ? authors + '. ' : ''}"${article.title}." ${article.source}, ${year}. Malayan Athletic Archive, ${today}, ${window.location.origin}.`,
        
        Chicago: `${authors ? authors + '. ' : ''}"${article.title}." ${article.source}, ${year}. Malayan Athletic Archive. Accessed ${today}. ${window.location.origin}.`
    };
    
    document.getElementById('citationAPA').textContent = citations.APA;
    document.getElementById('citationMLA').textContent = citations.MLA;
    document.getElementById('citationChicago').textContent = citations.Chicago;
    
    // Show citation modal
    document.getElementById('citationModal').style.display = 'block';
}

function copyCitation(format) {
    const citationText = document.getElementById(`citation${format}`).textContent;
    
    navigator.clipboard.writeText(citationText).then(() => {
        const button = event.target.closest('.copy-btn');
        const originalText = button.innerHTML;
        
        button.innerHTML = '<i class="fas fa-check"></i> Copied!';
        button.classList.add('copied');
        
        setTimeout(() => {
            button.innerHTML = originalText;
            button.classList.remove('copied');
        }, 2000);
    }).catch(err => {
        console.error('Failed to copy citation:', err);
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = citationText;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
    });
}

function printArticle() {
    const article = window.currentArticle;
    if (!article) return;
    
    const printWindow = window.open('', '_blank');
    printWindow.document.write(`
        <html>
        <head>
            <title>${article.title}</title>
            <style>
                body { font-family: Georgia, serif; max-width: 800px; margin: 0 auto; padding: 2rem; }
                .header { border-bottom: 2px solid #d97706; padding-bottom: 1rem; margin-bottom: 2rem; }
                .title { color: #d97706; font-size: 1.5rem; margin-bottom: 0.5rem; }
                .meta { color: #666; margin-bottom: 1rem; }
                .content { line-height: 1.7; white-space: pre-wrap; }
                img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; }
            </style>
        </head>
        <body>
            <div class="header">
                <h1 class="title">${article.title}</h1>
                <div class="meta">
                    <p><strong>Date:</strong> ${article.dateText}</p>
                    <p><strong>Source:</strong> ${article.source}</p>
                    <p><strong>Location:</strong> ${article.location}</p>
                    <p><strong>People:</strong> ${article.people.join(', ')}</p>
                </div>
            </div>
            <div class="image-section" style="text-align: center; margin-bottom: 2rem;">
                <img src="${article.image}" alt="${article.title}">
            </div>
            <div class="content">
                ${article.content}
            </div>
            <div style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #ddd; font-size: 0.9rem; color: #666;">
                <p>Printed from Malayan Athletic Archive - ${window.location.origin}</p>
                <p>Date accessed: ${new Date().toLocaleDateString('en-GB')}</p>
            </div>
        </body>
        </html>
    `);
    printWindow.document.close();
    printWindow.print();
}

function shareArticle() {
    const article = window.currentArticle;
    if (!article) return;
    
    const url = window.location.origin + window.location.pathname + '?article=' + article.id;
    
    // Always copy to clipboard first
    navigator.clipboard.writeText(url).then(() => {
        // Show success message
        showToast('Link copied to clipboard! You can now paste it anywhere to share.');
        
        // Also try native share if available (mobile)
        if (navigator.share && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            const shareData = {
                title: article.title,
                text: `${article.title} - From the Malayan Athletic Archive`,
                url: url
            };
            setTimeout(() => {
                navigator.share(shareData).catch(() => {
                    // User cancelled share, link is already copied
                });
            }, 500);
        }
    }).catch(err => {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = url;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            showToast('Link copied to clipboard!');
        } catch (err) {
            alert('Please copy this link: ' + url);
        }
        document.body.removeChild(textArea);
    });
}

// Toast notification function
function showToast(message) {
    // Remove existing toast if any
    const existingToast = document.querySelector('.toast-notification');
    if (existingToast) {
        existingToast.remove();
    }
    
    // Create new toast
    const toast = document.createElement('div');
    toast.className = 'toast-notification';
    toast.innerHTML = `
        <i class="fas fa-check-circle"></i>
        <span>${message}</span>
    `;
    document.body.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
        toast.classList.add('show');
    }, 10);
    
    // Remove after 3 seconds
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
            toast.remove();
        }, 300);
    }, 3000);
}

// Handle direct article links
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const articleId = urlParams.get('article');
    
    if (articleId) {
        // Wait for archive to load, then show the article
        const checkArchive = setInterval(() => {
            if (typeof archive !== 'undefined' && archive.articles.length > 0) {
                clearInterval(checkArchive);
                setTimeout(() => viewArticleDetail(articleId), 500);
            }
        }, 100);
    }
});
</script>